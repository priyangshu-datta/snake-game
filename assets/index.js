const l=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function s(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(e){if(e.ep)return;e.ep=!0;const r=s(e);fetch(e.href,r)}};l();class a{draw(){const{x:t,y:s}=y();document.querySelector(`.box:nth-child(${u({x:t,y:s})}):not(.mouth):not(.body)`)!==null?document.querySelector(`.box:nth-child(${u({x:t,y:s})}):not(.mouth):not(.body)`).classList.add("fruit"):this.draw()}undraw(){document.querySelector(".fruit").classList.remove("fruit")}}function y(){let i=Math.round(Math.random()*15.01),t=Math.round(Math.random()*15.01);return{x:i,y:t}}function u({x:i,y:t}){return 15*(t-1)+i}const n=new a;class f{constructor(){this.reset(),this.lost=!1,this.body=3,this.key_pressed=!1}reset(){n.draw(),document.querySelector(".score").textContent=0,this.path=[],this.direction="right",this.x=5,this.y=2,this.prevX=this.x,this.prevY=this.y,document.querySelector(`.box:nth-child(${o({x:5,y:2})})`).classList.add("mouth")}draw(){document.querySelector(`.box:nth-child(${o({x:this.x,y:this.y})})`).classList.add("mouth");for(let t=0;t<this.body;t++)this.path[t]!==void 0&&document.querySelector(`.box:nth-child(${o({x:this.path[t].x,y:this.path[t].y})})`).classList.add("body")}undraw(){document.querySelector(`.box:nth-child(${o({x:this.prevX,y:this.prevY})})`).classList.remove("mouth");for(let t=1;t<=this.body;t++)this.path[t]!==void 0&&document.querySelector(`.box:nth-child(${o({x:this.path[t].x,y:this.path[t].y})})`).classList.remove("body")}async controls(t){if(this.lost)return;let s=[`${this.x}, ${this.y-1}`,`${this.x}, ${this.y+1}`,`${this.x-1}, ${this.y}`,`${this.x+1}, ${this.y}`],c=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(t);if(this.path[0]!==void 0&&s[c]===`${this.path[0].x}, ${this.path[0].y}`){this.key_pressed=!1;return}this.prevDir=this.direction;let e=["up","down","left","right"];if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].map((r,h)=>{r===t&&(this.direction=e[h])}),await this.isCollision()){n.undraw(),this.lost=!0;return}switch(this.direction=this.prevDir,this.prevX=this.x,this.prevY=this.y,this.path.unshift({x:this.x,y:this.y}),t){case"ArrowUp":this.isBoundary({x:this.x,y:this.y-1})||(this.y-=1,this.direction="up");break;case"ArrowDown":this.isBoundary({x:this.x,y:this.y+1})||(this.y+=1,this.direction="down");break;case"ArrowLeft":this.isBoundary({x:this.x-1,y:this.y})||(this.x-=1,this.direction="left");break;case"ArrowRight":this.isBoundary({x:this.x+1,y:this.y})||(this.x+=1,this.direction="right");break}if(this.undraw(),this.draw(),this.hasEaten()&&(this.body+=1),await this.isCollision()){n.undraw(),this.lost=!0;return}this.key_pressed=!1}isBoundary({x:t,y:s}){return t>15||t<1||s<1||s>15?(console.log("Lost"),this.lost=!0,!0):!1}async progress(){switch(this.prevX=this.x,this.prevY=this.y,this.path.unshift({x:this.x,y:this.y}),this.direction){case"up":this.isBoundary({x:this.x,y:this.y-1})||(this.y-=1);break;case"down":this.isBoundary({x:this.x,y:this.y+1})||(this.y+=1);break;case"left":this.isBoundary({x:this.x-1,y:this.y})||(this.x-=1);break;case"right":this.isBoundary({x:this.x+1,y:this.y})||(this.x+=1);break}this.undraw(),this.draw(),this.hasEaten()&&(this.body+=1),await this.isCollision()&&(n.undraw(),this.lost=!0)}hasEaten(){if(document.querySelector(".fruit")!==null){const t=document.querySelector(".mouth").getBoundingClientRect(),s=document.querySelector(".fruit").getBoundingClientRect();if(t.top<=s.bottom&&t.right>=s.left&&t.bottom>=s.top&&t.left<=s.right)return document.querySelector(".score").textContent=parseInt(document.querySelector(".score").textContent)+1,x(),!0}}async isCollision(){try{switch(this.direction){case"up":if([...document.querySelector(`.box:nth-child(${o({x:this.x,y:this.y-1})})`).classList].includes("body"))return!0;break;case"down":if([...document.querySelector(`.box:nth-child(${o({x:this.x,y:this.y+1})})`).classList].includes("body"))return!0;break;case"left":if([...document.querySelector(`.box:nth-child(${o({x:this.x-1,y:this.y})})`).classList].includes("body"))return!0;break;case"right":if([...document.querySelector(`.box:nth-child(${o({x:this.x+1,y:this.y})})`).classList].includes("body"))return!0;break}}catch{return!1}}}function x(){n.undraw(),n.draw()}function o({x:i,y:t}){return 15*(t-1)+i}let d;document.querySelector(".start").addEventListener("click",()=>{document.querySelector(".dialouge").style.display="none";const i=new f;document.addEventListener("keydown",t=>{i.key_pressed=!0,i.controls(t.key)}),d=setInterval(()=>{if(i.lost){clearInterval(d),console.log("Lost"),[...document.querySelectorAll(".box")].forEach(t=>{t.classList.remove("body"),t.classList.remove("mouth"),t.classList.remove("fruit")}),document.querySelector(".dialouge").style.display="grid",document.querySelector(".gameover").style.display="block",document.querySelector(".start").innerText="Retry";return}i.key_pressed||i.progress()},1e3)});
